<Window x:Class="MarcoERP.WpfUI.Views.Shell.LoginWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:local="clr-namespace:MarcoERP.WpfUI.Common"
        Title="MarcoERP — تسجيل الدخول"
        Height="520" Width="420"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        FlowDirection="RightToLeft"
        FocusManager.FocusedElement="{Binding ElementName=txtUsername}">

    <Window.InputBindings>
        <KeyBinding Key="Enter" Command="{Binding LoginCommand}" />
    </Window.InputBindings>

    <Border CornerRadius="12"
            Background="White"
            BorderBrush="{StaticResource PrimaryBrush}"
            BorderThickness="2"
            local:WindowDragBehavior.IsEnabled="True">

        <Border.Effect>
            <DropShadowEffect BlurRadius="25" ShadowDepth="0" Opacity="0.35"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0"
                    Background="{StaticResource PrimaryBrush}"
                    CornerRadius="10,10,0,0"
                    Padding="20">

                <StackPanel HorizontalAlignment="Center">
                    <materialDesign:PackIcon Kind="Domain"
                                             Width="48"
                                             Height="48"
                                             Foreground="White"/>
                    <TextBlock Text="MarcoERP"
                               FontSize="28"
                               FontWeight="Bold"
                               Foreground="White"
                               Margin="0,8,0,0"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="نظام إدارة الموارد"
                               FontSize="14"
                               Foreground="#CCFFFFFF"
                               HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Form -->
            <StackPanel Grid.Row="1"
                        Margin="30"
                        VerticalAlignment="Center">

                <TextBlock Text="تسجيل الدخول"
                           FontSize="18"
                           FontWeight="SemiBold"
                           Margin="0,0,0,24"
                           HorizontalAlignment="Center"/>

                <TextBox x:Name="txtUsername"
                         materialDesign:HintAssist.Hint="اسم المستخدم"
                         materialDesign:HintAssist.IsFloating="True"
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}"
                         Margin="0,0,0,16"/>

                <Grid Margin="0,0,0,8">
                    <PasswordBox x:Name="txtPassword"
                                 materialDesign:HintAssist.Hint="كلمة المرور"
                                 materialDesign:HintAssist.IsFloating="True"
                                 Style="{StaticResource MaterialDesignOutlinedPasswordBox}"
                                 local:PasswordBoxAssistant.BoundPassword="{Binding Password, Mode=TwoWay}"
                                 Padding="0,0,36,0"
                                 Visibility="{Binding IsPasswordVisible, Converter={StaticResource InverseBoolToVisConverter}}" />
                    <TextBox materialDesign:HintAssist.Hint="كلمة المرور"
                             materialDesign:HintAssist.IsFloating="True"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Text="{Binding Password, UpdateSourceTrigger=PropertyChanged}"
                             Padding="0,0,36,0"
                             Visibility="{Binding IsPasswordVisible, Converter={StaticResource BooleanToVisibilityConverter}}" />
                    <ToggleButton Style="{StaticResource MaterialDesignIconForegroundButton}"
                                  IsChecked="{Binding IsPasswordVisible}"
                                  HorizontalAlignment="Left" VerticalAlignment="Center"
                                  Margin="281,0,0,0" Padding="4"
                                  ToolTip="إظهار/إخفاء كلمة المرور" Width="68" Height="43">
                        <materialDesign:PackIcon Kind="EyeOutline" Width="23" Height="18" HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </ToggleButton>
                </Grid>

                <!-- تذكرني -->
                <CheckBox Content="تذكرني"
                          IsChecked="{Binding RememberMe}"
                          FontSize="12"
                          Margin="0,2,0,12"
                          FlowDirection="RightToLeft"
                          VerticalContentAlignment="Center" />

                <!-- Loading Indicator -->
                <ProgressBar x:Name="progressBar"
                             Height="4"
                             IsIndeterminate="True"
                             Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}"
                             Margin="0,0,0,16"/>

                <TextBlock x:Name="lblError"
                           Foreground="{StaticResource ErrorForegroundBrush}"
                           FontSize="12"
                           TextWrapping="Wrap"
                           Text="{Binding ErrorMessage}"
                           Visibility="{Binding HasError, Converter={StaticResource BooleanToVisibilityConverter}}"
                           Margin="0,0,0,16"/>

                <Button x:Name="btnLogin"
                        Content="دخول"
                        Height="42"
                        Style="{StaticResource MaterialDesignRaisedButton}"
                        Background="{StaticResource PrimaryBrush}"
                        Foreground="White"
                    IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"
                    Command="{Binding LoginCommand}"/>

                <Button Content="إغلاق"
                        Margin="0,12,0,0"
                        Style="{StaticResource MaterialDesignFlatButton}"
                        Foreground="Gray"
                        Command="{Binding CloseCommand}"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>
