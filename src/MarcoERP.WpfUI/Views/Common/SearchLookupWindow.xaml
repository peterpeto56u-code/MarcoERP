<Window x:Class="MarcoERP.WpfUI.Views.Common.SearchLookupWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="بحث"
        Width="580" Height="480"
        WindowStartupLocation="CenterOwner"
        FlowDirection="RightToLeft"
        ResizeMode="CanResizeWithGrip"
        ShowInTaskbar="False"
        FontFamily="Segoe UI"
        TextElement.FontSize="12"
        PreviewKeyDown="Window_PreviewKeyDown"
        FocusManager.FocusedElement="{Binding ElementName=txtSearch}"
        Background="{DynamicResource MaterialDesignPaper}">

    <Window.Resources>
        <Style x:Key="HintText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#90A4AE" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>
    </Window.Resources>

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>   <!-- Search box -->
            <RowDefinition Height="*"/>      <!-- DataGrid -->
            <RowDefinition Height="Auto"/>   <!-- Bottom bar -->
        </Grid.RowDefinitions>

        <!-- ═══ Search Box ═══ -->
        <Border Grid.Row="0" Background="{StaticResource BackgroundBrush}" CornerRadius="6" Padding="8,4" Margin="0,0,0,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <materialDesign:PackIcon Grid.Column="0" Kind="Magnify" Width="20" Height="20"
                                         VerticalAlignment="Center" Foreground="{StaticResource SubtitleBrush}" Margin="0,0,6,0"/>

                <TextBox x:Name="txtSearch" Grid.Column="1" 
                         VerticalAlignment="Center" FontSize="14"
                         BorderThickness="0" Background="Transparent"
                         materialDesign:HintAssist.Hint="اكتب للبحث... (اسم، كود، باركود)"
                         TextChanged="SearchBox_TextChanged"/>

                <TextBlock x:Name="txtResultCount" Grid.Column="2"
                           Style="{StaticResource HintText}" Margin="6,0,0,0"/>
            </Grid>
        </Border>

        <!-- ═══ Results DataGrid ═══ -->
        <DataGrid Grid.Row="1" x:Name="dgResults"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserReorderColumns="False"
                  SelectionMode="Single"
                  SelectionUnit="FullRow"
                  HeadersVisibility="Column"
                  GridLinesVisibility="Horizontal"
                  HorizontalGridLinesBrush="#E0E0E0"
                  AlternatingRowBackground="#FAFAFA"
                  RowHeight="32"
                  FontSize="12"
                  MouseDoubleClick="DataGrid_MouseDoubleClick"
                  KeyDown="DataGrid_KeyDown">

            <DataGrid.ColumnHeaderStyle>
                <Style TargetType="DataGridColumnHeader"
                       BasedOn="{StaticResource MaterialDesignDataGridColumnHeader}">
                    <Setter Property="FontSize" Value="11"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="Foreground" Value="#546E7A"/>
                    <Setter Property="Background" Value="#ECEFF1"/>
                    <Setter Property="Padding" Value="8,4"/>
                    <Setter Property="HorizontalContentAlignment" Value="Right"/>
                </Style>
            </DataGrid.ColumnHeaderStyle>

            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow"
                       BasedOn="{StaticResource MaterialDesignDataGridRow}">
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#E3F2FD"/>
                            <Setter Property="Foreground" Value="#1565C0"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>
        </DataGrid>

        <!-- ═══ Bottom Bar ═══ -->
        <Grid Grid.Row="2" Margin="0,8,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" Style="{StaticResource HintText}"
                       Text="F1 = فتح | Enter = اختيار | Esc = إلغاء" FontSize="10"/>

            <Button Grid.Column="2" Content="اختيار" Click="SelectButton_Click"
                    Style="{StaticResource MaterialDesignFlatButton}"
                    Foreground="White" Background="#1976D2"
                    Padding="16,6" FontSize="12" Margin="0,0,6,0"
                    materialDesign:ButtonAssist.CornerRadius="4">
                <Button.Resources>
                    <Style TargetType="Border">
                        <Setter Property="CornerRadius" Value="4"/>
                    </Style>
                </Button.Resources>
            </Button>

            <Button Grid.Column="3" Content="إلغاء" IsCancel="True"
                    Style="{StaticResource MaterialDesignFlatButton}"
                    Foreground="{StaticResource StatusTextBrush}" Padding="16,6" FontSize="12"
                    materialDesign:ButtonAssist.CornerRadius="4"/>
        </Grid>
    </Grid>
</Window>
