<UserControl x:Class="MarcoERP.WpfUI.Views.Reports.BalanceSheetView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             FlowDirection="RightToLeft">
    <DockPanel Margin="16">
        <Border DockPanel.Dock="Top" Style="{StaticResource CardPanel}" Padding="16" Margin="0,0,0,12">
            <StackPanel>
                <TextBlock Text="الميزانية العمومية" Style="{StaticResource PageTitle}" Margin="0,0,0,12" />
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="كما في تاريخ:" VerticalAlignment="Center" Margin="0,0,8,0" />
                    <DatePicker SelectedDate="{Binding AsOfDate}" Width="160" Margin="0,0,16,0" />
                    <Button Content="عرض" Command="{Binding GenerateCommand}"
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            materialDesign:ButtonAssist.CornerRadius="4" Padding="16,6" />
                    <Button Content="PDF" Command="{Binding ExportPdfCommand}" Margin="8,0,0,0"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            materialDesign:ButtonAssist.CornerRadius="4" Padding="12,4" />
                    <Button Content="Excel" Command="{Binding ExportExcelCommand}" Margin="4,0,0,0"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            materialDesign:ButtonAssist.CornerRadius="4" Padding="12,4" />
                </StackPanel>
            </StackPanel>
        </Border>
        <Border DockPanel.Dock="Bottom" Background="{StaticResource ErrorBackgroundBrush}" CornerRadius="4" Padding="8" Margin="0,4,0,0"
                Visibility="{Binding HasError, Converter={StaticResource BooleanToVisibilityConverter}}">
            <TextBlock Text="{Binding ErrorMessage}" Foreground="{StaticResource DangerBrush}" FontSize="12" />
        </Border>
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="12" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <!-- Assets (Right column for RTL) -->
                <StackPanel Grid.Column="0">
                    <Border Style="{StaticResource CardPanel}" Padding="12" Margin="0,0,0,8">
                        <StackPanel>
                            <TextBlock Text="الأصول" Style="{StaticResource SectionTitle}"
                                       Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,8" />
                            <DataGrid ItemsSource="{Binding AssetRows}" AutoGenerateColumns="False" IsReadOnly="True"
                                      CanUserAddRows="False" HeadersVisibility="None" Background="Transparent"
                                      materialDesign:DataGridAssist.CellPadding="8 4" GridLinesVisibility="None">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding AccountCode}" Width="80" />
                                    <DataGridTextColumn Binding="{Binding AccountNameAr}" Width="*" />
                                    <DataGridTextColumn Binding="{Binding Balance, StringFormat=N2}" Width="120" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <Separator Margin="0,8" />
                            <DockPanel Margin="8,4">
                                <TextBlock Text="إجمالي الأصول" FontWeight="Bold" FontSize="15" />
                                <TextBlock Text="{Binding TotalAssets, StringFormat=N2}" FontWeight="Bold"
                                           FontSize="15" Foreground="{StaticResource PrimaryBrush}"
                                           HorizontalAlignment="Left" Margin="30,0,0,0" />
                            </DockPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
                <!-- Liabilities & Equity (Left column for RTL) -->
                <StackPanel Grid.Column="2">
                    <Border Style="{StaticResource CardPanel}" Padding="12" Margin="0,0,0,8">
                        <StackPanel>
                            <TextBlock Text="الخصوم" Style="{StaticResource SectionTitle}"
                                       Foreground="{StaticResource DangerBrush}" Margin="0,0,0,8" />
                            <DataGrid ItemsSource="{Binding LiabilityRows}" AutoGenerateColumns="False" IsReadOnly="True"
                                      CanUserAddRows="False" HeadersVisibility="None" Background="Transparent"
                                      materialDesign:DataGridAssist.CellPadding="8 4" GridLinesVisibility="None">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding AccountCode}" Width="80" />
                                    <DataGridTextColumn Binding="{Binding AccountNameAr}" Width="*" />
                                    <DataGridTextColumn Binding="{Binding Balance, StringFormat=N2}" Width="120" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <Separator Margin="0,4" />
                            <DockPanel Margin="8,4">
                                <TextBlock Text="إجمالي الخصوم" FontWeight="Bold" />
                                <TextBlock Text="{Binding TotalLiabilities, StringFormat=N2}" FontWeight="Bold"
                                           Foreground="{StaticResource DangerBrush}" HorizontalAlignment="Left" Margin="30,0,0,0" />
                            </DockPanel>
                        </StackPanel>
                    </Border>
                    <Border Style="{StaticResource CardPanel}" Padding="12" Margin="0,0,0,8">
                        <StackPanel>
                            <TextBlock Text="حقوق الملكية" Style="{StaticResource SectionTitle}"
                                       Foreground="{StaticResource SuccessBrush}" Margin="0,0,0,8" />
                            <DataGrid ItemsSource="{Binding EquityRows}" AutoGenerateColumns="False" IsReadOnly="True"
                                      CanUserAddRows="False" HeadersVisibility="None" Background="Transparent"
                                      materialDesign:DataGridAssist.CellPadding="8 4" GridLinesVisibility="None">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding AccountCode}" Width="80" />
                                    <DataGridTextColumn Binding="{Binding AccountNameAr}" Width="*" />
                                    <DataGridTextColumn Binding="{Binding Balance, StringFormat=N2}" Width="120" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <DockPanel Margin="8,4">
                                <TextBlock Text="الأرباح المحتجزة" FontWeight="SemiBold" />
                                <TextBlock Text="{Binding RetainedEarnings, StringFormat=N2}" FontWeight="SemiBold"
                                           HorizontalAlignment="Left" Margin="30,0,0,0" />
                            </DockPanel>
                            <Separator Margin="0,4" />
                            <DockPanel Margin="8,4">
                                <TextBlock Text="إجمالي حقوق الملكية" FontWeight="Bold" />
                                <TextBlock Text="{Binding TotalEquity, StringFormat=N2}" FontWeight="Bold"
                                           Foreground="{StaticResource SuccessBrush}" HorizontalAlignment="Left" Margin="30,0,0,0" />
                            </DockPanel>
                        </StackPanel>
                    </Border>
                    <Border Background="{StaticResource PrimaryBrush}" CornerRadius="4" Padding="12,10">
                        <DockPanel>
                            <TextBlock Text="إجمالي الخصوم وحقوق الملكية" FontWeight="Bold" FontSize="15" Foreground="White" />
                            <TextBlock Text="{Binding TotalLiabilitiesAndEquity, StringFormat=N2}" FontWeight="Bold"
                                       FontSize="15" Foreground="White" HorizontalAlignment="Left" Margin="30,0,0,0" />
                        </DockPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </ScrollViewer>
    </DockPanel>
</UserControl>
