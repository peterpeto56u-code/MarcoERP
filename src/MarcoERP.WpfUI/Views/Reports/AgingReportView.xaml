<UserControl x:Class="MarcoERP.WpfUI.Views.Reports.AgingReportView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             FlowDirection="RightToLeft">
    <DockPanel Margin="16">
        <Border DockPanel.Dock="Top" Style="{StaticResource CardPanel}" Padding="16" Margin="0,0,0,12">
            <DockPanel>
                <TextBlock Text="تقرير أعمار الديون" Style="{StaticResource PageTitle}" />
                <Button Content="تحديث" Command="{Binding GenerateCommand}"
                        Style="{StaticResource MaterialDesignRaisedButton}"
                        materialDesign:ButtonAssist.CornerRadius="4" Padding="16,6" HorizontalAlignment="Left" Margin="24,0,0,0" />
                <Button Content="PDF" Command="{Binding ExportPdfCommand}" Margin="8,0,0,0"
                        Style="{StaticResource MaterialDesignOutlinedButton}"
                        materialDesign:ButtonAssist.CornerRadius="4" Padding="12,4" />
                <Button Content="Excel" Command="{Binding ExportExcelCommand}" Margin="4,0,0,0"
                        Style="{StaticResource MaterialDesignOutlinedButton}"
                        materialDesign:ButtonAssist.CornerRadius="4" Padding="12,4" />
            </DockPanel>
        </Border>
        <Border DockPanel.Dock="Bottom" Background="{StaticResource ErrorBackgroundBrush}" CornerRadius="4" Padding="8" Margin="0,4,0,0"
                Visibility="{Binding HasError, Converter={StaticResource BooleanToVisibilityConverter}}">
            <TextBlock Text="{Binding ErrorMessage}" Foreground="{StaticResource DangerBrush}" FontSize="12" />
        </Border>
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Customer Aging -->
                <Border Style="{StaticResource CardPanel}" Padding="12" Margin="0,0,0,12">
                    <StackPanel>
                        <DockPanel Margin="0,0,0,8">
                            <TextBlock Text="أعمار ديون العملاء" Style="{StaticResource SectionTitle}"
                                       Foreground="{StaticResource DangerBrush}" />
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="24,0,0,0">
                                <TextBlock Text="الإجمالي:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,4,0" />
                                <TextBlock Text="{Binding TotalCustomerBalance, StringFormat=N2}" FontWeight="Bold"
                                           FontSize="14" Foreground="{StaticResource DangerBrush}" VerticalAlignment="Center" />
                            </StackPanel>
                        </DockPanel>
                        <DataGrid ItemsSource="{Binding CustomerRows}" AutoGenerateColumns="False" IsReadOnly="True"
                                  CanUserAddRows="False" materialDesign:DataGridAssist.CellPadding="10 6" Background="White">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="الكود" Binding="{Binding Code}" Width="80" />
                                <DataGridTextColumn Header="الاسم" Binding="{Binding Name}" Width="*" />
                                <DataGridTextColumn Header="جاري" Binding="{Binding Current, StringFormat=N2}" Width="100" />
                                <DataGridTextColumn Header="30 يوم" Binding="{Binding Days30, StringFormat=N2}" Width="100" />
                                <DataGridTextColumn Header="60 يوم" Binding="{Binding Days60, StringFormat=N2}" Width="100" />
                                <DataGridTextColumn Header="90 يوم" Binding="{Binding Days90, StringFormat=N2}" Width="100" />
                                <DataGridTextColumn Header="+120 يوم" Binding="{Binding Days120Plus, StringFormat=N2}" Width="100">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock"><Setter Property="Foreground" Value="{StaticResource DangerBrush}" /></Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="الإجمالي" Binding="{Binding Total, StringFormat=N2}" Width="110">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock"><Setter Property="FontWeight" Value="Bold" /></Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
                <!-- Supplier Aging -->
                <Border Style="{StaticResource CardPanel}" Padding="12">
                    <StackPanel>
                        <DockPanel Margin="0,0,0,8">
                            <TextBlock Text="أعمار ديون الموردين" Style="{StaticResource SectionTitle}"
                                       Foreground="{StaticResource WarningBrush}" />
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="24,0,0,0">
                                <TextBlock Text="الإجمالي:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,4,0" />
                                <TextBlock Text="{Binding TotalSupplierBalance, StringFormat=N2}" FontWeight="Bold"
                                           FontSize="14" Foreground="{StaticResource WarningBrush}" VerticalAlignment="Center" />
                            </StackPanel>
                        </DockPanel>
                        <DataGrid ItemsSource="{Binding SupplierRows}" AutoGenerateColumns="False" IsReadOnly="True"
                                  CanUserAddRows="False" materialDesign:DataGridAssist.CellPadding="10 6" Background="White">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="الكود" Binding="{Binding Code}" Width="80" />
                                <DataGridTextColumn Header="الاسم" Binding="{Binding Name}" Width="*" />
                                <DataGridTextColumn Header="جاري" Binding="{Binding Current, StringFormat=N2}" Width="100" />
                                <DataGridTextColumn Header="30 يوم" Binding="{Binding Days30, StringFormat=N2}" Width="100" />
                                <DataGridTextColumn Header="60 يوم" Binding="{Binding Days60, StringFormat=N2}" Width="100" />
                                <DataGridTextColumn Header="90 يوم" Binding="{Binding Days90, StringFormat=N2}" Width="100" />
                                <DataGridTextColumn Header="+120 يوم" Binding="{Binding Days120Plus, StringFormat=N2}" Width="100">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock"><Setter Property="Foreground" Value="{StaticResource DangerBrush}" /></Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="الإجمالي" Binding="{Binding Total, StringFormat=N2}" Width="110">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock"><Setter Property="FontWeight" Value="Bold" /></Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </DockPanel>
</UserControl>
